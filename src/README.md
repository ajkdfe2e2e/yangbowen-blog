# Cloudflare Worker é€‚é…å±‚

è¿™æ˜¯å°† Next.js åšå®¢é¡¹ç›®é€‚é…ä¸º Cloudflare Worker çš„é€‚é…å±‚ã€‚

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### æ–‡ä»¶ç»“æ„
```
src/
â”œâ”€â”€ index.js          # Workerä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ handlers/
â”‚   â”œâ”€â”€ posts.js      # æ–‡ç« APIå¤„ç†å™¨
â”‚   â”œâ”€â”€ weather.js    # å¤©æ°”APIå¤„ç†å™¨
â”‚   â””â”€â”€ static.js     # é™æ€èµ„æºå¤„ç†å™¨
â””â”€â”€ README.md         # è¯´æ˜æ–‡æ¡£
```

### ä¸»è¦åŠŸèƒ½

1. **APIé€‚é…**: å°†Next.jsçš„APIè·¯ç”±é€‚é…ä¸ºWorkeræ ¼å¼
2. **é™æ€é¡µé¢**: æä¾›ç®€åŒ–çš„HTMLé¡µé¢
3. **CORSæ”¯æŒ**: è‡ªåŠ¨å¤„ç†è·¨åŸŸè¯·æ±‚
4. **ç¯å¢ƒå˜é‡**: æ”¯æŒCloudflareç¯å¢ƒå˜é‡é…ç½®

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### æ–¹æ³•1: GitHub Actionsè‡ªåŠ¨éƒ¨ç½²

1. **é…ç½®Secrets**:
   - `CLOUDFLARE_API_TOKEN`: Cloudflare APIä»¤ç‰Œ
   - `CLOUDFLARE_ACCOUNT_ID`: Cloudflareè´¦æˆ·ID

2. **æ¨é€ä»£ç **: 
   ```bash
   git push origin main
   ```

3. **è‡ªåŠ¨éƒ¨ç½²**: GitHub Actionsä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°Cloudflare Workers

### æ–¹æ³•2: æœ¬åœ°éƒ¨ç½²

```bash
# å®‰è£…ä¾èµ–
npm install

# æœ¬åœ°å¼€å‘
npm run worker:dev

# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
npm run worker:deploy
```

## ğŸŒ API æ¥å£

### æ–‡ç« API
- `GET /api/posts` - è·å–æ‰€æœ‰æ–‡ç« 
- `GET /api/posts?slug=æ–‡ç« æ ‡è¯†` - è·å–å•ç¯‡æ–‡ç« 
- `POST /api/posts` - åˆ›å»ºæ–‡ç« 
- `PUT /api/posts?slug=æ–‡ç« æ ‡è¯†` - æ›´æ–°æ–‡ç« 
- `DELETE /api/posts?slug=æ–‡ç« æ ‡è¯†` - åˆ é™¤æ–‡ç« 

### å¤©æ°”API
- `GET /api/weather?city=åŸå¸‚å` - è·å–æŒ‡å®šåŸå¸‚å¤©æ°”

## ğŸ“„ é¡µé¢è·¯ç”±
- `/` - é¦–é¡µ
- `/posts` - æ–‡ç« åˆ—è¡¨
- `/create` - åˆ›å»ºæ–‡ç« 
- `/admin` - ç®¡ç†ç•Œé¢
- `/posts/[slug]` - æ–‡ç« è¯¦æƒ…

## âš¡ æŠ€æœ¯ç‰¹ç‚¹

1. **é›¶å†·å¯åŠ¨**: Cloudflare Worker æ— æœåŠ¡å™¨æ¶æ„
2. **å…¨çƒCDN**: è‡ªåŠ¨å…¨çƒåˆ†å‘ï¼Œè®¿é—®é€Ÿåº¦å¿«
3. **é«˜æ€§èƒ½**: è¾¹ç¼˜è®¡ç®—ï¼Œå“åº”æ—¶é—´ < 50ms
4. **æˆæœ¬ä½å»‰**: æ¯å¤©10ä¸‡æ¬¡è¯·æ±‚å…è´¹
5. **è‡ªåŠ¨æ‰©ç¼©**: æ— éœ€æ‹…å¿ƒæµé‡å³°å€¼

## ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®

åœ¨ Cloudflare Dashboard ä¸­è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```
AMAP_API_KEY = ä½ çš„é«˜å¾·åœ°å›¾APIå¯†é’¥
MINIMAX_TOKEN = ä½ çš„MiniMax_AI_Token
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

- **å®æ—¶æ—¥å¿—**: Cloudflare Dashboard â†’ Workers â†’ é¡¹ç›® â†’ Logs
- **æ€§èƒ½ç›‘æ§**: å†…ç½®æ€§èƒ½åˆ†æå’Œé”™è¯¯è¿½è¸ª
- **ä½¿ç”¨ç»Ÿè®¡**: è¯·æ±‚é‡ã€é”™è¯¯ç‡ã€å“åº”æ—¶é—´ç­‰

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **éƒ¨ç½²å¤±è´¥**:
   - æ£€æŸ¥API Tokenæƒé™
   - ç¡®è®¤Account IDæ­£ç¡®
   - æŸ¥çœ‹GitHub Actionsæ—¥å¿—

2. **APIé”™è¯¯**:
   - æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
   - æŸ¥çœ‹Workerå®æ—¶æ—¥å¿—
   - ç¡®è®¤å¤–éƒ¨APIå¯è®¿é—®æ€§

3. **é¡µé¢æ— æ³•è®¿é—®**:
   - ç¡®è®¤åŸŸåé…ç½®
   - æ£€æŸ¥WorkerçŠ¶æ€
   - æŸ¥çœ‹CDNç¼“å­˜è®¾ç½®

## ğŸ”„ æ•°æ®æŒä¹…åŒ–

å½“å‰ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼ŒWorkeré‡å¯ä¼šä¸¢å¤±æ•°æ®ã€‚

**ç”Ÿäº§ç¯å¢ƒå»ºè®®**:
- ä½¿ç”¨ Cloudflare KV å­˜å‚¨
- è¿æ¥å¤–éƒ¨æ•°æ®åº“
- å¯ç”¨æ•°æ®å¤‡ä»½ç­–ç•¥

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

1. **ç¼“å­˜ç­–ç•¥**: é™æ€èµ„æºCDNç¼“å­˜
2. **å‹ç¼©ä¼˜åŒ–**: è‡ªåŠ¨Gzipå‹ç¼©
3. **ä»£ç åˆ†å‰²**: æŒ‰éœ€åŠ è½½èµ„æº
4. **å›¾ç‰‡ä¼˜åŒ–**: WebPæ ¼å¼æ”¯æŒ

## ğŸŒŸ åŠŸèƒ½æ‰©å±•

- [ ] ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [ ] è¯„è®ºåŠŸèƒ½
- [ ] æœç´¢å¼•æ“ä¼˜åŒ–
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] ä¸»é¢˜åˆ‡æ¢
- [ ] è®¢é˜…æ¨é€

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [Cloudflare Workers æ–‡æ¡£](https://developers.cloudflare.com/workers/)
2. æ£€æŸ¥é¡¹ç›® Issues
3. è”ç³»å¼€å‘è€…: yangbowen@email.com